define(["jquery","theme_bloom/jquery.scrollTo","theme_bloom/onDemand"],function(n,e,a){var t=function(){if(n(".ajaxcalendar").length>0){var e=n("#event_detail_box"),a=-60;e.on("click",".backto-calendar",function(e){e.preventDefault(),n(this).removeClass("move"),r(n(this).attr("href"),a)}),n(".ajaxcalendar .has-event").on("click",".event-detail li, .day",function(t){t.preventDefault();var o=n(this).find("a"),l=o.attr("href"),i=l.substring(l.indexOf("#"));o.parents("td").addClass("loader"),e.find(".event").length>0&&e.find(".event").fadeOut(300),n.ajax({url:l,dataType:"html"}).done(function(t){var o="",d=e,c=n(t).find(".ajax-maincalendar");o="<h2>"+c.find(".controls span.current").html()+"</h2>",o+=c.find(".eventlist").html()+"<a href='#region-main' title='Back to Calendar' class='btn btn-primary backto-calendar'>Back to Calendar</a>",e.html(o),n(".btn.backto-calendar").ondemand(n(".ajaxcalendar"))," "!==i&&i!==l&&(d=n(i)),r(d,a)})})}},r=function(e,a){n("body").scrollTo(e,500,{offset:function(){return{top:a,left:0}},onAfter:function(){n("td.loader").removeClass("loader")}})};return{init:function(){"use strict";n(document).ready(function(){t()})}}});
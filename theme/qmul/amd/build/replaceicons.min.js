define(["jquery","jqueryui","core/log"],function(a,b,c){return{init:function(){c.debug("QMUL Slideout Replace Icons JS initialised");var b=this;a(document).ready(function(){b.replace(),Y.use("moodle-core-event",function(){Y.Global.on(M.core.globalEvents.BLOCK_CONTENT_UPDATED,function(){b.replace(),console.log(b.done)})});var a=new MutationObserver(function(a){a.forEach(function(a){"childList"==a.type&&b.replace()})}),c={attributes:!0,childList:!0,characterData:!0};a.observe(document.querySelector("body"),c)})},replacements:[],replace:function(){if(a("img.icon, img.iconsmall, img.smallicon").length>0){var b={};a("img.icon, img.iconsmall, img.smallicon").each(function(){if(a(this).parents(".editor_atto").length)return!0;var c=a(this),d=(c.attr("id"),c.next());if(0===d.length||!a(d).hasClass("glyphicon")){var e=c.attr("src");e=e.split("/"),e=e.slice(-2);var f=e[0]+"/"+e[1];c.attr("data-replaceme",1),c.attr("data-iconname",f);var g=c.attr("class");b[f]={iconname:f,classes:g}}}),a.ajax({url:M.cfg.wwwroot+"/theme/qmul/lib/icon.php",context:document.body,method:"POST",data:{icons:b}}).done(function(b){for(var c in b){var d=b[c];a('[data-iconname="'+c+'"]').each(function(){if(""==d)a(this).removeClass("hidden");else{var b=a(this).next();0!==b.length&&a(b).hasClass("glyphicon")||(a(this).after(d),a(this).addClass("hidden"))}})}})}}}});
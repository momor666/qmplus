<nav role="header" class="navbar navbar-inverse bg-primary fixed-top d-block">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <div class="row">
                    <div class="navbar-header col-3">
                        <a class="navbar-brand" href="<?php echo $CFG->wwwroot;?>">
                            <?php echo $logo; ?>
                        </a>
                    </div>
                    <div class="menuarea pull-right col-9 d-flex justify-content-end">
                        <?php
                            if (isloggedin() && !isguestuser()) {
                        ?>
                            <div class="dropdown recentcourses hidden-sm-down">
                                <button class="btn btn-outline-secondary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <?php echo get_string('recentcourses', 'theme_qmul'); ?>
                                </button>
                                <div class="dropdown-menu">
                                    <?php
                                        $courses = theme_qmul_get_recent_courses();
                                        foreach ($courses as $course) {
                                            $class = '';
                                            $icon = '';
                                            if (!$course->visible) {
                                                $class = 'notvisible';
                                                $icon = $OUTPUT->pix_icon('i/show', 'core');
                                            }
                                            $url = new moodle_url('/course/view.php', array('id'=>$course->id));
                                            $link = html_writer::link($url, $icon.$course->fullname, array('class'=>$class));
                                            echo $link;
                                        }
                                        $url = new moodle_url('/course/index.php');
                                        $link = html_writer::link($url, '<i>'.get_string('viewallcourses', 'theme_qmul').'</i>');
                                        echo $link;
                                    ?>
                                </div>
                            </div>
                        <?php
                            }
                            if ($PAGE->pagelayout != 'login') {
                        ?>
                        <div class="search">
                            <a class="nav-link" title="<?php echo get_string('search', 'theme_qmul') ?>">
                                <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><g transform="translate(-1289.000000, -25.000000)" fill="#FFFFFF"><g><title><?php echo get_string('search', 'theme_qmul') ?></title><path d="M1302.84615,33.4615385 C1302.84615,31.9791593 1302.31932,30.7111431 1301.26562,29.6574519 C1300.21193,28.6037608 1298.94392,28.0769231 1297.46154,28.0769231 C1295.97916,28.0769231 1294.71114,28.6037608 1293.65745,29.6574519 C1292.60376,30.7111431 1292.07692,31.9791593 1292.07692,33.4615385 C1292.07692,34.9439177 1292.60376,36.2119338 1293.65745,37.265625 C1294.71114,38.3193162 1295.97916,38.8461538 1297.46154,38.8461538 C1298.94392,38.8461538 1300.21193,38.3193162 1301.26562,37.265625 C1302.31932,36.2119338 1302.84615,34.9439177 1302.84615,33.4615385 Z M1309,43.4615385 C1309,43.8782072 1308.84776,44.2387805 1308.54327,44.5432692 C1308.23878,44.8477579 1307.87821,45 1307.46154,45 C1307.02884,45 1306.66827,44.8477579 1306.37981,44.5432692 L1302.25721,40.4326923 C1300.82291,41.426287 1299.22437,41.9230769 1297.46154,41.9230769 C1296.3157,41.9230769 1295.21996,41.7007234 1294.17428,41.2560096 C1293.1286,40.8112959 1292.22717,40.2103403 1291.46995,39.453125 C1290.71274,38.6959097 1290.11178,37.7944764 1289.66707,36.7487981 C1289.22235,35.7031198 1289,34.6073775 1289,33.4615385 C1289,32.3156994 1289.22235,31.2199572 1289.66707,30.1742788 C1290.11178,29.1286005 1290.71274,28.2271672 1291.46995,27.4699519 C1292.22717,26.7127366 1293.1286,26.1117811 1294.17428,25.6670673 C1295.21996,25.2223535 1296.3157,25 1297.46154,25 C1298.60738,25 1299.70312,25.2223535 1300.7488,25.6670673 C1301.79448,26.1117811 1302.69591,26.7127366 1303.45312,27.4699519 C1304.21034,28.2271672 1304.8113,29.1286005 1305.25601,30.1742788 C1305.70072,31.2199572 1305.92308,32.3156994 1305.92308,33.4615385 C1305.92308,35.2243678 1305.42629,36.8229095 1304.43269,38.2572115 L1308.55529,42.3798077 C1308.85176,42.6762835 1309,43.0368569 1309,43.4615385 Z"></path>
                                </g></g></g></svg>
                            </a>
                            <span class="closebutton">
                                <svg version="1.2" preserveAspectRatio="none" viewBox="0 0 24 24"><g><path xmlns:default="http://www.w3.org/2000/svg" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" style="fill: rgb(245, 245, 245);"></path>
                                <title><?php echo get_string('close', 'theme_qmul') ?></title>
                                </g></svg>
                            </span>
                        </div>
                        <?php
                            }
                            echo $OUTPUT->navbar_plugin_output();
                        ?>
                            <a title="<?php echo get_string('zoom', 'theme_qmul') ?>" href="javascript://void(0);" class="zoomcontent nav-link">
                                <svg class="shrink" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <title><?php echo get_string('zoom', 'theme_qmul') ?></title>
                                        <g transform="translate(-1132.000000, -114.000000)" fill="#FFFFFF">
                                            <path d="M1152,115.458333 L1147.72917,119.729167 L1150.33333,122.333333 L1143.66667,122.333333 L1143.66667,115.666667 L1146.27083,118.270833 L1150.54167,114 L1152,115.458333 Z M1152,132.541667 L1150.54167,134 L1146.27083,129.729167 L1143.66667,132.333333 L1143.66667,125.666667 L1150.33333,125.666667 L1147.72917,128.270833 L1152,132.541667 Z M1132,132.541667 L1136.27083,128.270833 L1133.66667,125.666667 L1140.33333,125.666667 L1140.33333,132.333333 L1137.72917,129.729167 L1133.45833,134 L1132,132.541667 Z M1132,115.458333 L1133.45833,114 L1137.72917,118.270833 L1140.33333,115.666667 L1140.33333,122.333333 L1133.66667,122.333333 L1136.27083,119.729167 L1132,115.458333 Z"></path>
                                        </g>
                                    </g>
                                </svg>
                                <svg class="expand" width="20px" height="21px" viewBox="0 0 20 21" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <title><?php echo get_string('normal', 'theme_qmul') ?></title>
                                        <g transform="translate(-1077.000000, -114.000000)" fill="#FFFFFF">
                                            <path d="M1088.125,121.375 L1092.125,117.375 L1089,114.25 L1097,114.25 L1097,122.25 L1093.875,119.125 L1089.875,123.125 L1088.125,121.375 Z M1088.125,127.125 L1089.875,125.375 L1093.875,129.375 L1097,126.25 L1097,134.25 L1089,134.25 L1092.125,131.125 L1088.125,127.125 Z M1085.875,127.125 L1081.875,131.125 L1085,134.25 L1077,134.25 L1077,126.25 L1080.125,129.375 L1084.125,125.375 L1085.875,127.125 Z M1085.875,121.375 L1084.125,123.125 L1080.125,119.125 L1077,122.25 L1077,114.25 L1085,114.25 L1081.875,117.375 L1085.875,121.375 Z"></path>
                                        </g>
                                    </g>
                                </svg>
                            </a>
                        <?php
                            if (isloggedin() && !isguestuser()) {
                                echo $OUTPUT->login_info();
                            } else {
                        ?>
                            <a  href="<?php echo $CFG->wwwroot ?>/login/index.php" class="login nav-link" title="<?php echo get_string('login') ?>">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 320 320" width="20px" height="20px">
                                    <title><?php echo get_string('login') ?></title>
                                    <g>
                                        <path d="M169.392,194.395c-5.858,5.858-5.858,15.355,0,21.213c2.929,2.929,6.768,4.394,10.606,4.394   c3.839,0,7.678-1.464,10.606-4.394l44.998-44.997c0.35-0.351,0.683-0.719,0.997-1.103c0.137-0.167,0.256-0.344,0.385-0.515   c0.165-0.22,0.335-0.435,0.488-0.664c0.14-0.209,0.261-0.426,0.389-0.64c0.123-0.206,0.252-0.407,0.366-0.619   c0.118-0.22,0.217-0.446,0.323-0.67c0.104-0.219,0.213-0.435,0.306-0.659c0.09-0.219,0.163-0.442,0.243-0.664   c0.087-0.24,0.178-0.477,0.253-0.722c0.067-0.222,0.116-0.447,0.172-0.672c0.063-0.249,0.133-0.497,0.184-0.751   c0.051-0.259,0.082-0.521,0.119-0.782c0.032-0.223,0.075-0.443,0.097-0.669c0.048-0.484,0.073-0.971,0.074-1.457   c0-0.007,0.001-0.015,0.001-0.022c0-0.007-0.001-0.015-0.001-0.022c-0.001-0.487-0.026-0.973-0.074-1.458   c-0.022-0.223-0.064-0.44-0.095-0.661c-0.038-0.264-0.069-0.528-0.121-0.79c-0.05-0.252-0.119-0.496-0.182-0.743   c-0.057-0.227-0.107-0.456-0.175-0.681c-0.073-0.241-0.164-0.474-0.249-0.711c-0.081-0.226-0.155-0.453-0.247-0.675   c-0.091-0.22-0.199-0.431-0.3-0.645c-0.108-0.229-0.21-0.46-0.33-0.685c-0.11-0.205-0.235-0.4-0.354-0.599   c-0.132-0.221-0.256-0.444-0.4-0.659c-0.146-0.219-0.309-0.424-0.466-0.635c-0.136-0.181-0.262-0.368-0.407-0.544   c-0.299-0.364-0.616-0.713-0.948-1.048c-0.016-0.016-0.029-0.034-0.045-0.05l-45-45.001c-5.858-5.858-15.355-5.857-21.213,0   c-5.858,5.858-5.858,15.355,0,21.213l19.394,19.395H15c-8.284,0-15,6.716-15,15c0,8.284,6.716,15,15,15h173.785L169.392,194.395z" fill="#FFFFFF"/>
                                        <path d="M305,25H115c-8.284,0-15,6.716-15,15v60c0,8.284,6.716,15,15,15s15-6.716,15-15V55h160V265H130v-45.001   c0-8.284-6.716-15-15-15s-15,6.716-15,15V280c0,8.284,6.716,15,15,15h190c8.284,0,15-6.716,15-15V40C320,31.715,313.284,25,305,25z   " fill="#FFFFFF"/>
                                    </g>
                                </svg>
                            </a>
                        <?php
                            }
                        ?>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>
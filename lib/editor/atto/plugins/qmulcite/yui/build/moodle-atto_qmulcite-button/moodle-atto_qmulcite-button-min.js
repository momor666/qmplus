YUI.add("moodle-atto_qmulcite-button",function(t){t.namespace("M.atto_qmulcite").Button=t.Base.create("button",t.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({icon:"e/cite",callback:this._Cite})},_CiteExist:function(t){var e=t.commonAncestorContainer;return e="undefined"!=typeof e?e.parentNode:t.parentElement,"CITE"==e.tagName?(e.outerHTML=e.outerHTML+e.innerHTML,document.getElementById(e.id).remove(),!0):this._hasClass(e,"editor_atto_content_wrap")?!1:this._CiteExist(e)},_Cite:function(){var t="uniqueCiteId"+Math.floor(15*Math.random()),e=document.getSelection().getRangeAt(0),n='<cite id="'+t+'">'+e.toString()+"</cite>&nbsp;",i=this._CiteExist(e);(i||"CITE"===e.startContainer.tagName||"CITE"===e.endContainer.tagName)&&(n=e.toString()),document.execCommand("insertHTML",!1,n),this.markUpdated()},_hasClass:function(t,e){return t.className&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});